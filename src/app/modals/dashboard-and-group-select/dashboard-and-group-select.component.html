<ion-header>
	<ion-toolbar class="top">
		<ion-buttons slot="start">
			<ion-icon size="large" name="close-outline" (click)="cancel()"></ion-icon>
		</ion-buttons>
		<ion-title>Manage</ion-title>
	</ion-toolbar>
	<ion-item class="top-bar">
		<ion-label class="top-bar-inner"
			>My Dashboards
			<span style="padding-left: 5px; opacity: 0.7"
				>{{ dashboards() ? sortedValidatorDashboards().length : '-' }} / {{ maxAllowedDashboards() }}
			</span></ion-label
		>
		<ion-icon class="opacity-icon top-bar-inner touch-icon-padding" slot="end" name="add-circle-outline" id="add-dashboard"></ion-icon>
	</ion-item>
	<ion-popover trigger="add-dashboard" triggerAction="click" [dismissOnSelect]="true">
		<ng-template>
			<ion-content>
				<ion-list>
					<ion-item *ngFor="let item of dashboardAddButtons" [button]="true" [detail]="false" (click)="addDashboard(item.network)">{{
						item.text
					}}</ion-item>
				</ion-list>
			</ion-content>
		</ng-template>
	</ion-popover>
	<app-offline *ngIf="!online"></app-offline>
</ion-header>

<ion-content>
	<app-full-page-loading [loading]="initLoading">
		<app-full-page-offline
			(retry)="this.doRefresh()"
			[online]="online || dashboards()?.validator_dashboards ? true : false || legacyDashboard.length > 0">
			<div class="message" *ngIf="!infoDismissed">
				<ion-list>
					<ion-item lines="none" class="premium">
						<ion-icon slot="start" name="information-circle-outline" class="opacity-icon" class="prem-icon"></ion-icon>
						<ion-label class="prem-title">New: Your Dashboards</ion-label>
						<ion-icon (click)="dismissInfo()" slot="end" name="close-outline" class="opacity-icon prem-x"></ion-icon>
					</ion-item>
					<span class="hint"
						>You may have more than one dashboard. Each dashboard is associated with a network, like Ethereum or Gnosis. The new groups feature allows
						you to further organize a dashboard.</span
					>
				</ion-list>
			</div>

			<div class="message" *ngIf="!isLoggedIn" (click)="signIn()">
				<ion-list>
					<ion-item lines="none" class="premium">
						<ion-icon slot="start" name="person-circle-outline" class="opacity-icon" class="prem-icon"></ion-icon>
						<ion-label class="prem-title">Sign in to beaconcha.in</ion-label>
						<ion-icon slot="end" name="chevron-forward-outline" class="opacity-icon prem-x"></ion-icon>
					</ion-item>
					<span class="hint">Get free notifications about your validators, manage or share your dashboards and stay in sync from web or app. </span>
				</ion-list>
			</div>

			<div class="message" *ngIf="!merchant.isPremium() && isLoggedIn" (click)="sellUp()">
				<ion-list>
					<ion-item lines="none" class="premium">
						<ion-icon slot="start" name="rocket-outline" class="opacity-icon" class="prem-icon"></ion-icon>
						<ion-label class="prem-title">Get more with Premium</ion-label>
						<ion-icon slot="end" name="chevron-forward-outline" class="opacity-icon prem-x"></ion-icon>
					</ion-item>
					<span class="hint"
						>Premium lets you track more validators, access more dashboards and groups, extended history timeframes and much more.</span
					>
				</ion-list>
			</div>

			<app-dashboard-item
				*ngFor="let item of sortedValidatorDashboards()"
				[data]="item"
				[defaultDashboard]="defaultDashboard"
				(refresh)="doRefresh()"></app-dashboard-item>

			<div class="nothingfound" *ngIf="sortedValidatorDashboards().length == 0">
				<ion-icon name="telescope-outline"></ion-icon>
				<h2>No Dashboards</h2>
				<div style="padding-bottom: 10px">
					<ion-label> Do you want to create a new one?</ion-label>
				</div>
				<ion-label class="link" (click)="addDashboard(dashboardAddButtons[0].network)">Create Dashboard</ion-label>
			</div>

			<div *ngIf="legacyDashboard.length > 0">
				<ion-list-header>
					<ion-label>Old App Dashboards</ion-label>
				</ion-list-header>
				<app-dashboard-item
					*ngFor="let item of legacyDashboard"
					(legacyAdd)="legacyAddToDashboard($event)"
					[defaultDashboard]="defaultDashboard"
					[legacyDashboard]="true"
					[defaultDashboard]="defaultDashboard"
					[data]="item"
					(refresh)="doRefresh()"></app-dashboard-item>
			</div>
		</app-full-page-offline>
	</app-full-page-loading>
</ion-content>
